$(document).ready(function(){function t(t){for(var e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",a="",i=t;i>0;--i)a+=e[Math.floor(Math.random()*e.length)];return a}function e(e){$(e).each(function(){var e=t(40);$(this).attr("id",e);var a="&module="+$(this).attr("data-module")+"&key="+e;$(this).attr("data-key",e);var i=e+"-list";$(this).find(".file-uploader-list").attr("id",i),$("#"+i).attr("data-source","/upload-list"),$("#"+i).attr("data-extra",a),$("#"+i).html("");var r=$(this).attr("data-module"),o=$(this).attr("data-module-id"),s=$(this).attr("data-key"),n=$(this).find(".file-uploader-button");$(n).uploadFile({url:"/upload",fileName:"file",returnType:"json",uploadStr:n.attr("data-upload-button"),maxFileSize:n.attr("data-max-size"),autoSubmit:!0,dragDrop:!1,multiple:!1,formData:{module:r,module_id:o,key:s},onSuccess:function(t,e){toastr.success(e.message,"",{positionClass:K}),M(e.key+"-list")},onError:function(t,e,a){toastr.error(a,"",{positionClass:K})}})})}function a(){$("#sidebar-menu > ul > li > a").click(function(){$("#sidebar-menu li").removeClass("selected"),$(this).closest("li").addClass("selected");var t=$(this).next();return t.is("ul")&&t.is(":visible")&&($(this).closest("li").removeClass("selected"),t.slideUp("fast")),t.is("ul")&&!t.is(":visible")&&($("#sidebar-menu ul ul:visible").slideUp("fast"),t.slideDown("fast")),0==$(this).closest("li").find("ul").children().length?!0:!1})}function i(){$.ajax({url:"/sidebar",data:{lock:1,menu:ne},error:function(){},dataType:"html",success:function(t){$("#sidebar-menu-list").html(t),$("#sidebar-menu-list li").not(".no-sort").sort(r).appendTo("#sidebar-menu-list"),$("#sidebar-menu-list li").not(".no-sort").each(function(t,e){0==$(e).data("visible")&&$(e).hide()}),a()},type:"POST"})}function r(t,e){return $(e).data("position")<$(t).data("position")?1:-1}function o(){$(".enable-show-hide").each(function(){var t=$(this).attr("name");s(t)})}function s(t,e){if(void 0===e&&(e=0),e)var a="#myModal ";else var a="";$(a+"#"+t+"_field").length&&(n(t,e),$(a+'input[name="'+t+'"]').on("switchChange.bootstrapSwitch",function(){n(t,e)}))}function n(t,e){if(e)var a="#myModal ";else var a="";var i=t+"_field";$(a+'input[name="'+t+'"]').is(":checked")?$(a+"#"+i).show():$(a+"#"+i).hide()}function l(t){$(t+" #template_id").on("change",function(){$.ajax({url:$(t).attr("data-url"),type:"post",data:{template_id:$(this).val(),user_id:$(t).attr("data-user-id"),invoice_id:$(t).attr("data-invoice-id"),quotation_id:$(t).attr("data-quotation-id")},error:function(){},success:function(e){"success"==e.status&&($(t+" #mail_subject").val(e.subject),$(t+" #mail_body").summernote("code",e.body))}})})}function d(t){$(t).iCheck({checkboxClass:"icheckbox_flat-blue",radioClass:"iradio_flat-blue",increaseArea:"20%"})}function c(t){$(t).selectpicker({size:5,liveSearch:!0})}function u(t){$(t).length&&$(t).summernote({placeholder:"Type here",height:$(".summernote").attr("data-height")?$(".summernote").attr("data-height"):100})}function h(t){$(t).length&&$(t).redactor({minHeight:300})}function p(t){$(t).length>0&&$(t).datepicker({format:"yyyy-mm-dd",clearBtn:!0})}function m(t){$(t).length>0&&$(t).datepicker({format:"yyyy-mm-dd",autoclose:!0,multidate:!1,clearBtn:!0,todayHighlight:!0,language:re})}function f(){$("textarea").on("propertychange keyup input paste",function(){if($(this).attr("data-show-counter")>0){var t=$(this).attr("data-limit")?$(this).data("limit"):J,e=t-$(this).val().length;e>0||$(this).val($(this).val().substring(0,t)),$(this).next("span").text((e>0?e:0)+" "+V)}})}function g(){$.each($("textarea[data-autoresize]"),function(){var t=this.offsetHeight-this.clientHeight,e=function(e){$(e).css("height","auto").css("height",e.scrollHeight+t)};$(this).on("keyup input",function(){e(this)}).removeAttr("data-autoresize")})}function v(t){if($("#"+t).attr("data-extra"))var e="table=table"+$("#"+t).attr("data-extra");else var e="table=table";$.ajax({url:$("#"+t).attr("data-source"),data:e,error:function(){},dataType:"html",success:function(e){$("#"+t+"> tbody").html(e),$(".show-table td:last-child").addClass("text-right")},type:"POST"})}function b(){$("#myModal .enable-show-hide").each(function(){var t=$(this).attr("name");s(t,1)}),P(1),p("#myModal .input-daterange"),$("#myModal .file-uploader").length&&e("#myModal .file-uploader"),$("#myModal .switch-input").bootstrapSwitch(),$('input[data-role="tagsinput"]').length&&$('input[data-role="tagsinput"]').tagsinput("refresh"),$(".show-table td:last-child").addClass("text-right"),c("#myModal .show-tick"),d("#myModal .icheck"),m("#myModal .datepicker"),u("#myModal .summernote"),h("#myModal .readactor"),f(),g();var t=$("#myModal").find("form");$("#myModal").find("form").on("submit",function(e){"noAjax"!=$(t).attr("data-submit")&&(e.preventDefault(),x($(t)))}),$("#myModal .password-strength").pwstrength(),$("#invoice-custom-email-form").length&&l("#invoice-custom-email-form"),$("#quotation-custom-email-form").length&&l("#quotation-custom-email-form")}function y(){mail_driver=$("#mail_driver").val(),$(".mail_config").hide(),"smtp"==mail_driver?$("#smtp_configuration").show():"mandrill"==mail_driver?$("#mandrill_configuration").show():"mailgun"==mail_driver?$("#mailgun_configuration").show():$(".mail_config").hide()}function w(){$("form").on("submit",function(t){var e=$("#"+$(this).attr("id"));"noAjax"!=e.attr("data-submit")&&(t.preventDefault(),x(e))})}function x(t){$(t).find(".switch-input").each(function(){if(!$(this).is(":checked")&&0==$(this).attr("data-off-value"))var e='<input type="hidden" name="'+$(this).attr("name")+'" value="0" />';$(t).append(e)}),t.find(":submit").prop("disabled",!0),$("#loading-img").fadeIn("slow"),toastr.info(X,"",{positionClass:K}),$("#"+t.attr("id")).find(".form-group").removeClass("has-error");var a=new FormData($("#"+t.attr("id"))[0]);if(t.attr("data-file-upload")){var r=[];$("#"+t.attr("id")).find(t.attr("data-file-upload")).each(function(){r.push($(this).attr("data-key"))}),a.append("upload_key[]",r)}a.append("ajax_submit",1),t.attr("data-draggable")&&$(".draggable-container .draggable").each(function(t,e){a.append($(e).attr("data-name"),$(e).attr("data-index"))}),$.ajax({url:t.attr("action"),type:"post",contentType:!1,processData:!1,data:a,success:function(a){var r=a.redirect?a.redirect:t.attr("data-redirect")?t.attr("data-redirect"):"",o=t.attr("data-redirect-msg")?t.attr("data-redirect-msg"):Z,s=t.attr("data-redirect-duration")?t.attr("data-redirect-duration"):2e3;toastr.clear(),"error"==a.status?(toastr.error(a.message,"",{positionClass:K}),r&&setTimeout(function(){window.location.href=r},s)):(a.message&&toastr.success(a.message,"",{positionClass:K}),r&&(toastr.success(o,"",{positionClass:K}),setTimeout(function(){window.location.href=r},s)),$("#myModal").modal("hide"),$(".datatable").length>0&&S(),t.attr("data-refresh")&&M(t.attr("data-refresh")),t.attr("data-no-form-clear")||_(t),t.attr("data-sidebar")&&i(),$("#setup_guide").length>0&&$("#setup_guide").html(a.setup_guide),t.attr("data-setup-guide-complete")&&$("#setup_panel").hide(),t.attr("data-table-refresh")&&v(t.attr("data-table-refresh")),a.refresh_table&&v(a.refresh_table),a.refresh_content&&M(a.refresh_content),a.new_data&&$("#"+a.new_data.field).length>0&&($("#"+a.new_data.field).append('<option value="'+a.new_data.id+'">'+a.new_data.value+"</option>"),$("#"+a.new_data.field).selectpicker("refresh")),$("#designation-hierarchy").length&&D("designation"),t.attr("data-file-upload")&&e(t.attr("data-file-upload")))},error:function(e){if(toastr.clear(),422===e.status){var a=JSON.parse(e.responseText),i="";$.each(a,function(e,a){$("#"+t.attr("id")+' input[name="'+e+'"]').closest(".form-group").addClass("has-error"),""==i&&($("#"+t.attr("id")+' input[name="'+e+'"]').focus(),ee||(i=a[0]+"<br />")),ee&&(i+=a[0]+"<br />")}),toastr.error(i,"",{positionClass:K})}else toastr.error(Y,"",{positionClass:K})},complete:function(){t.find(":submit").prop("disabled",!1),$("#loading-img").fadeOut("slow")}})}function _(t){$(t).find(":input").each(function(){switch(this.type){case"email":case"url":case"number":case"password":case"text":case"textarea":case"file":$(this).val("");break;case"checkbox":case"radio":this.checked=!1,$(t).find(".icheck").iCheck({uncheckedClass:"",checkboxClass:"icheckbox_flat-blue",radioClass:"iradio_flat-blue",increaseArea:"20%"})}}),$(".switch-input").bootstrapSwitch("destroy",!0),$(".switch-input").bootstrapSwitch(),o(),$(".show-tick").selectpicker("val",""),$(".summernote").length&&$(t).find(".summernote").summernote("reset"),$('input[data-role="tagsinput"]').length&&$('input[data-role="tagsinput"]').tagsinput("removeAll")}function C(t){var e;return e=$("#"+t).attr("data-form")?$("#"+$("#"+t).attr("data-form")).serialize():{_token:G}}function k(t){return[{extend:"print",text:'<i class="fa fa-print"></i>',title:$("#"+t).attr("data-table-title"),exportOptions:{columns:":visible"}},{extend:"excel",text:'<i class="fa fa-file-excel-o"></i>',exportOptions:{columns:":visible"}},{extend:"pdf",text:'<i class="fa fa-file-pdf-o"></i>',title:$("#"+t).attr("data-table-title"),exportOptions:{columns:":visible"}},{extend:"copy",text:'<i class="fa fa-files-o"></i>',exportOptions:{columns:":visible"}},{extend:"colvis",text:'<i class="fa fa-columns"></i>'}]}function S(){$(".datatable").each(function(){var t=$(this).attr("id");pe[t].ajax.reload()})}function D(t){$.ajax({url:"/"+t+"/hierarchy",error:function(){},dataType:"html",success:function(e){$("#"+t+"-hierarchy").html(e)},type:"POST"})}function T(t){var e="ajax_submit=1";$(t).attr("data-extra")&&(e+=$(t).attr("data-extra")),$(t).attr("data-field")&&(e=e+"&"+$(t).attr("data-field")+"="+$("#"+$(t).attr("data-field")).val()),$.ajax({url:$(t).attr("data-source"),data:e,dataType:"json",type:"post",error:function(){toastr.error(Y,"",{positionClass:K})},success:function(e){"error"==e.status?toastr.error(e.message,"",{positionClass:K}):($(".datatable").length>0&&S(),$(t).attr("data-refresh")&&M($(t).attr("data-refresh")),$(t).attr("data-table-refresh")&&v($(t).attr("data-table-refresh")),$(t).hasClass("mark-hidden")&&$(t).parent("p").hide(),e.message&&toastr.success(e.message,"",{positionClass:K}),e.redirect&&setTimeout(function(){window.location.href=e.redirect},2e3))}})}function j(){$.ajax({url:"/fetch-chat",data:{lock:1},error:function(){},dataType:"html",success:function(t){$("#chat-messages").html(t),$("#chat-messages .textAvatar").nameBadge(),$("#chat-box").animate({scrollTop:$("#chat-messages").height()},"fast")},type:"POST"})}function F(){var t="token="+$("#load-message").attr("data-token");$.ajax({url:"/load-message",error:function(){},data:t,dataType:"html",success:function(t){$("#load-message").html(t),$("#load-message .textAvatar").nameBadge()},type:"POST"})}function E(t){var e="ajax=1";$("#"+t).attr("data-extra")&&(e+=$("#"+t).attr("data-extra")),$("#"+t).attr("data-field")&&(e=e+"&"+$("#"+t).attr("data-field")+"="+$("#"+$("#"+t).attr("data-field")).val());var a=$("#"+t).attr("data-source");$.ajax({url:a,error:function(){},data:e,dataType:"html",success:function(e){$("#"+t).html(e),$("#"+t+" .textAvatar").nameBadge(),$(".show-table td:last-child").addClass("text-right"),f(),g()},type:"POST"})}function M(t){for(var e=t.split(","),a=0;a<e.length;a++)"chat-messages"==e[a]?j():"load-message"==e[a]?F():$("#"+e[a]).length&&E(e[a])}function q(t,e){return t=""+t,t.length<e?q("0"+t,e):t}function A(t,e,a){$.ajax({url:"/currency-conversion-field",data:{currency_id:e,date:t},type:"POST",success:function(t){$(a).html(t)},error:function(){}})}function P(t){void 0===t&&(t=0);var e="#currency-conversion",a="#currency-date",i="#currency-conversion-field";t&&(e="#myModal "+e,a="#myModal "+a,i="#myModal "+i),$(e).on("change",function(){$(a).attr("data-currency-id",$(this).val()),$(e).attr("data-currency-id",$(this).val()),A($(this).attr("data-currency-date"),$(this).attr("data-currency-id"),i)}),$(a).on("blur",function(){$(a).attr("data-currency-date",$(this).val()),$(e).attr("data-currency-date",$(this).val()),A($(this).attr("data-currency-date"),$(this).attr("data-currency-id"),i)})}function O(t){var e="#"+t+"-payment-coupon,#"+t+"-payment-amount",a="#"+t+"-payment-coupon",i="#"+t+"-payment-amount",r="#"+t+"-payable-amount",o=$(r).attr("data-invoice-id");$(e).on("change",function(){$.ajax({url:"/validate-coupon",data:{coupon:$(a).val(),amount:$(i).val(),invoice_id:o},type:"POST",success:function(t){$(r).html(t.message)},error:function(){}})})}function z(){var t=$("select[name=item_type]");"quantity"==t.val()?($(".item-quantity-header").html("Quantity"),$(".item-price-header").html("Price")):"hour"==t.val()?($(".item-quantity-header").html("Hour"),$(".item-price-header").html("Rate")):$(".item-quantity").hide(),R()}function L(t,e){$("#"+t).on("ifChecked",function(){$("."+e).show(),R()}),$("#"+t).on("ifUnchecked",function(){$("."+e).hide(),R()})}function B(t,e){$("#"+t).prop("checked")?$("."+e).show():$("."+e).hide()}function H(t){var e=t.attr("data-unique-id"),a="item_id="+t.val()+"&currency_id="+$("#currency_id").val();$.ajax({url:"/item/fetch-price",type:"POST",data:a,error:function(){},success:function(t){console.log(t.unit);"error"==t.status?toastr.error(t.message,"",{positionClass:K}):"success"==t.status&&toastr.success(t.message,"",{positionClass:K}),$("#item_quantity_"+e).val()||$("#item_quantity_"+e).val(1),$("#item_price_"+e).val(t.unit_price),$("#item_unit_"+e).val(t.unit),$("#item_discount_"+e).val(t.discount),$("#item_tax_"+e).val(t.tax),$("#item_description_"+e).val(t.description),R()}})}function N(){$.ajax({url:"/add-item-row",type:"POST",error:function(){},success:function(t){"success"==t.status&&($("#table-invoice-item > tbody").append(t.data),B("subtotal1","item-subtotal1"),B("subtotal2","item-subtotal2"),B("subtotal3","item-subtotal3"),B("line_item_discount","item-discount"),B("line_item_tax","item-tax"),B("line_item_description","item-description"),B("subtotal_tax","subtotal-tax"),B("subtotal_discount","subtotal-discount"),B("subtotal_shipping_and_handling","subtotal-shipping-and-handling"),$("#invoice-items input").iCheck({checkboxClass:"icheckbox_flat-blue",radioClass:"iradio_flat-blue",increaseArea:"10%"}),$(".show-tick").selectpicker({liveSearch:!0,container:"body",size:5}),$(".item-row").length>1&&t.message&&toastr.success(t.message,"",{positionClass:K}),z())}})}function U(t){if($(".item-row").length>1){var e=t.parent().parent().attr("data-unique-id");$('[data-unique-id="'+e+'"]').remove(),toastr.success(oe,"",{positionClass:K}),R()}else toastr.error(se,"",{positionClass:K})}function R(){if($("#currency_id").length){var t="currency_id="+$("#currency_id").val();$.ajax({url:"/currency/fetch-detail",type:"POST",data:t,error:function(){},success:function(t){I(t.decimal_place,t.position,t.symbol),$(".all-item-price").attr("step","."+q(1,t.decimal_place))}})}}function I(t,e,a){var i=$("select[name=item_type]").val(),r=0;$(".item-row").each(function(){var o=0,s=0,n=0,l=$(this).attr("data-unique-id"),d="item_quantity_"+l,c="item_price_"+l,sub1="item_subtotal1_"+l,u="item_amount_"+l;if(o="amount_only"!=i?($("#"+d).val()?$("#"+d).val():0)*($("#"+c).val()?$("#"+c).val():0):$("#"+c).val()?$("#"+c).val():0,$("#line_item_discount").prop("checked")){var h="item_discount_"+l,p="item_discount_type_"+l;s=$("#"+h).val()?$("#"+h).val():0,o-=$("#"+p).prop("checked")?s:o*s/100}if($("#line_item_tax").prop("checked")){var m="item_tax_"+l;n=$("#"+m).val()?$("#"+m).val():0,o+=o*n/100}r+=o,$("#"+u).html(Q(o,t,e,a))});var o=r;$("#sub_total_amount").html(Q(r,t,e,a)),$("#subtotal_discount").prop("checked")&&(subtotal_discount=$('input[name="subtotal_discount_amount"]').val()?$('input[name="subtotal_discount_amount"]').val():0,o-=$('input[name="subtotal_discount_type"]').prop("checked")?+subtotal_discount:o*subtotal_discount/100),$("#subtotal_tax").prop("checked")&&(subtotal_tax=o*($('input[name="subtotal_tax_amount"]').val()?$('input[name="subtotal_tax_amount"]').val():0)/100,o+=+subtotal_tax),$("#subtotal_shipping_and_handling").prop("checked")&&(shipping_and_handling=$('input[name="subtotal_shipping_and_handling_amount"]').val()?$('input[name="subtotal_shipping_and_handling_amount"]').val():0,o+=+shipping_and_handling),$("#total_amount").html(Q(o,t,e,a))}function Q(t,e,a,i){return t=t.toFixed(e),"prefix"==a?i+" "+t:t+" "+i}function W(t){if(void 0===t&&(t=""),$("#currency_id").length){var e="currency_id="+$("#currency_id").val();$.ajax({url:"/currency/fetch-detail",type:"POST",data:e,error:function(){},success:function(e){if(""==t)$(".all-item-discount-type").each(function(){var t=$(this).attr("data-unique-id");$("#item_discount_type_"+t).prop("checked")&&$("#item_discount_type_label_"+t).html("("+e.symbol+")"),$('input[name="subtotal_discount_type"]').prop("checked")&&$(".subtotal_discount_type_label").html("("+e.symbol+")")});else{if(t.attr("data-unique-id")){var a=t.attr("data-unique-id");$("#item_discount_type_label_"+a).html("("+e.symbol+")")}else $(".subtotal_discount_type_label").html("("+e.symbol+")");R()}}})}}$.ajaxSetup({headers:{"X-CSRF-Token":$("meta[name=csrf-token]").attr("content")}}),$(window).load(function(){$("#loading").fadeOut("slow")});var G=$('meta[name="csrf-token"]').attr("content"),K=$("#js-var").attr("data-toastr-position"),Y=$("#js-var").attr("data-something-error-message"),V=$("#js-var").attr("data-character-remaining"),J=$("#js-var").attr("data-textarea-limit"),X=$("#js-var").attr("data-processing-messsage"),Z=$("#js-var").attr("data-redirecting-messsage"),te=$("#js-var").attr("data-action-confirm-message"),ee=$("#js-var").attr("data-show-error-message"),ae=$("#js-var").attr("data-calendar-language"),ie=$("#js-var").attr("data-datatable-language"),re=$("#js-var").attr("data-datepicker-language"),oe=$("#js-var").attr("data-row-deleted"),se=$("#js-var").attr("data-row-cannot-delete"),ne=$("#js-var").attr("data-menu"),le=$("#js-var").attr("data-stripe-publishable-key"),de=$("#js-var").attr("data-tco-mode"),ce=$("#js-var").attr("data-tco-seller-id"),ue=$("#js-var").attr("data-tco-publishable-key");$(".slimscroller").length&&$(".slimscroller").slimscroll({height:"auto",size:"15px",railOpacity:.3,wheelStep:5}),0==$(".configuration-list").children().length&&$(".configuration-list-container").hide(),$(".datepicker").each(function(){$(this).attr("readonly","readonly")}),$(".hidden_fields").each(function(){$(this).attr("readonly","readonly")}),$(".file-uploader").length&&e(".file-uploader"),$(".tab-list").each(function(){$(this).children().first().addClass("active")}),$(".tab-content div:first-child").addClass("active"),$(".show-count").each(function(){$(this).prop("Counter",0).animate({Counter:$(this).text()},{duration:4e3,easing:"swing",step:function(t){$(this).text(Math.ceil(t))}})}),$(".slider").length&&($(".slider").slider(),$(".slider").on("slide",function(t){var e=t.value,a=e[0]+"% to "+e[1]+"%";$("#slider-value").text(a)})),$(".tooltips").tooltip({selector:"[data-toggle=tooltip]",container:"body"}),$("button.show-sidebar").click(function(){$("div.left").toggleClass("mobile-sidebar"),$("div.right").toggleClass("mobile-content"),$("div.logo-brand").toggleClass("logo-brand-toggle")}),a(),$("#sidebar-menu").length&&i(),$(".draggable-container").length&&$(".draggable-container").sortable({update:function(){$(".draggable-container .draggable").each(function(t,e){$elm=$(e),$elm.attr("data-index",$elm.index(".draggable-container .draggable"))})}}),$(".switch-input").bootstrapSwitch(),$(".file-input").bootstrapFileInput(),$(".password-strength").pwstrength(),$(".textAvatar").nameBadge(),$(".show-table td:last-child").addClass("text-right"),m(".datepicker"),d(".icheck"),c(".show-tick"),u(".summernote"),h(".redactor"),o(),$("#staff-email-form").length&&l("#staff-email-form"),$("#customer-email-form").length&&l("#customer-email-form"),$("form").on("keyup keypress",function(t){var e=t.keyCode||t.which;return 13===e&&$(this).attr("data-disable-enter-submission")?(t.preventDefault(),!1):void 0}),$(document).on("click","[data-submit-alert-message]",function(t){t.preventDefault();var e=$(this),a=e.attr("data-alert-message")?e.attr("data-alert-message"):te;bootbox.confirm(a,function(t){if(t){var a=e.closest("form");"noAjax"!=a.attr("data-submit")?x(a):$(a).submit()}})}),$(document).on("click",".click-alert-message",function(t){t.preventDefault();var e=$(this),a=e.attr("data-alert-message")?e.attr("data-alert-message"):te;bootbox.confirm(a,function(t){t&&e.attr("data-ajax")&&T(e)})}),p(".input-daterange"),$("#myWizard").length>0&&$("#myWizard").easyWizard({buttonsClass:"btn btn-default",submitButtonClass:"btn btn-primary",showSteps:!0,showButtons:!0,submitButton:!1}),$(".custom-field-option").hide(),$(document).on("change","#type",function(){var t=$("#custom-field-form #type").val();"select"==t||"radio"==t||"checkbox"==t?$(".custom-field-option").show():$(".custom-field-option").hide()}),w(),g(),f(),$('input[data-role="tagsinput"]').length&&$('input[data-role="tagsinput"]').tagsinput("refresh"),$(".ajax-table").each(function(t,e){var a=$(e).attr("id");v(a)}),$("#myModal").on("show.bs.modal",function(t){var e=$(t.relatedTarget);e.attr("data-href")&&$.get(e.attr("data-href"),function(t){$("#myModal").find(".modal-content").html(t),$("#myModal").modal("show"),b()},"html")}),y(),$("#mail_driver").on("change",function(){y()}),$(".post-button").on("click",function(){$("#form-action").attr("value",$(this).attr("data-button-value"))}),$("#render_calendar").length>0&&$("#render_calendar").fullCalendar({header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},locale:ae,events:{url:"/calendar-events",type:"POST"},eventRender:function(t,e){$(e).tooltip({title:t.title})}});var he="<'row'<'col-sm-5 margin-left-10'li><'col-sm-5 pull-right margin-right-10'f>><'row'<'col-sm-12'tr>><'row'<'col-sm-4 margin-left-10'B><'col-sm-6 pull-right margin-right-10'p>>",pe=[];if($(".datatable").length>0&&$(".datatable").each(function(){var t=$(this).attr("id");pe[t]=$("#"+t).DataTable({dom:he,buttons:k(t),ajax:{url:"/"+$("#"+t).attr("data-table-source")+"/lists",type:"post",data:function(){return C(t)}},ordering:!0,autoWidth:!0,language:{url:ie},order:$("#"+t).attr("data-disable-sorting")?[]:[[1,"asc"]],columnDefs:$("#"+t).attr("data-disable-sorting")?[]:[{orderable:!1,targets:0}]}),$("#"+t).on("xhr.dt",function(e,a,i){if(i.foot){var r=$("#"+t).find("tfoot");r.length||(r=$("<tfoot>").appendTo("#"+t)),r.html(i.foot)}})}),$("#designation-hierarchy").length&&D("designation"),$(document.body).on("click","a",function(t){$('[data-toggle="tooltip"]').tooltip("destroy"),$(this).attr("data-ajax")&&!$(this).hasClass("click-alert-message")&&(t.preventDefault(),T(this))}),$("#chat-messages").length&&(j(),$("#chat-messages").attr("data-chat-refresh")>0&&setInterval(function(){j()},1e3*$("#chat-messages").attr("data-chat-refresh-duration"))),$("#load-message").length&&F(),$("#currency-list").length&&E("currency-list"),$("#load-user-detail").length&&E("load-user-detail"),$("#load-quotation-discussion").length&&E("load-quotation-discussion"),$(".login-as").on("click",function(){$("input[name='username']").val($(this).attr("data-username")),$("input[name='email']").val($(this).attr("data-email")),$("input[name='password']").val($(this).attr("data-password"))}),$(document).on("click",".quotation-discussion-reply-button",function(){toastr.info(X,"",{positionClass:K});var t=($(this).attr("data-extra"),$(this).attr("data-quotation-discussion-id")),e=$(this).attr("data-token"),a=$(this).attr("data-url"),i=$("#comment_"+e).val();$(this).addClass("disabled");var r=$(this);$.ajax({url:a,type:"post",data:{quotation_discussion_id:t,comment:i},error:function(){},success:function(t){"error"==t.status?(toastr.error(t.message,"",{positionClass:K}),$("#comment_"+e).focus()):"success"==t.status&&(toastr.success(t.message,"",{positionClass:K}),$("#comment_"+e).val(""),$("#comment_"+e).next("span").text(""),$("#reply_"+e+" ul").append(t.new_data),$("#reply_"+e+" .textAvatar").nameBadge())},complete:function(){r.removeClass("disabled")}})}),$("#conversion_date").on("change",function(){E("currency-list")}),P(),$("#load-quotation-status").length&&E("load-quotation-status"),$("#load-quotation-action-button").length&&E("load-quotation-action-button"),O("paypal"),O("stripe"),O("tco"),O("payumoney"),$("#load-invoice-status").length&&E("load-invoice-status"),$("#load-invoice-action-button").length&&E("load-invoice-action-button"),$(document).on("change","#invoice-items input",function(){R()}),B("subtotal_tax","subtotal-tax"),B("subtotal1","item-subtotal1"),B("subtotal2","item-subtotal2"),B("subtotal3","item-subtotal3"),B("subtotal_discount","subtotal-discount"),B("subtotal_shipping_and_handling","subtotal-shipping-and-handling"),$("#invoice-page").length){var me=$("#table-invoice-item");me.attr("data-invoice-id")||N(),$(document).on("click",".add-invoice-row",function(){N()}),$(document).on("click",".delete-invoice-row",function(){U($(this))}),L("line_item_discount","item-discount"),L("line_item_tax","item-tax"),L("subtotal1","item-subtotal1"),L("subtotal2","item-subtotal2"),L("subtotal3","item-subtotal3"),L("line_item_description","item-description"),L("subtotal_tax","subtotal-tax"),L("subtotal_discount","subtotal-discount"),L("subtotal_shipping_and_handling","subtotal-shipping-and-handling"),$("select[name=item_type]").on("change",function(){$(".item-quantity").show(),$(".item-price").show(),z()})}if($("#invoice-page").length&&(R(),W()),$("#currency_id").on("change",function(){W(),$('[data-type="item-name"]').each(function(){H($(this))})}),$(document).on("ifUnchecked",".all-item-discount-type",function(){if($(this).attr("data-unique-id")){var t=$(this).attr("data-unique-id");$("#item_discount_type_label_"+t).html("(%)")}else $(".subtotal_discount_type_label").html("(%)");R()}),$(document).on("ifChecked",".all-item-discount-type",function(){var t=$(this);W(t)}),$("#due_date_detail").length){$("#due_date_detail").hide();var fe=$("select[name=due_date]");"due_on_date"==fe.val()&&$("#due_date_detail").show(),$(document).on("change","select[name=due_date]",function(){var t=$(this).val();"due_on_date"==t?$("#due_date_detail").show():$("#due_date_detail").hide()})}if($(document).on("change","select",function(){if($(this).attr("data-unique-id")){var t=$(this).attr("data-unique-id");if("custom_item"==$(this).val()){$(this).selectpicker("destroy");var e=$(this).parent();e.html('<input type="text" class="form-control invoice-input" placeholder="Item Name" name="item_name['+t+']"><input type="hidden" readonly name="item_name_detail['+t+'] value="1">'),$("#item_price_"+t).val(""),$("#item_discount_"+t).val(""),$("#item_tax_"+t).val(""),$("#item_description_"+t).val(""),e.find("input:first").focus(),R()}else field=$(this),H(field)}}),$(document).on("change","select",function(){var t=$(this).attr("data-unique-id");if("custom_tax"==$(this).val()){var e=$(this).parent();e.html('<input type="text" class="form-control invoice-input" placeholder="Item Tax" name="item_tax['+t+']">'),e.find("input:first").focus()}R()}),le){Stripe.setPublishableKey(le);var $e=function(t,e){var a=$("#stripe-payment-form");if(e.error)toastr.error(e.error.message,"",{positionClass:K}),a.find(":submit").prop("disabled",!1);else{var i=e.id;a.append($('<input type="hidden" name="stripeToken" />').val(i)),a.get(0).submit()}};$(function(t){t("#stripe-payment-form").submit(function(){var e=t(this);return e.find(":submit").prop("disabled",!0),Stripe.card.createToken(e,$e),!1})})}if(ue){var ge=function(t){var e=document.getElementById("tco-payment-form");e.token.value=t.response.token.token,e.submit()},ve=function(t){200===t.errorCode?(be(),$("#tco-payment-form").find(":submit").prop("disabled",!1)):(toastr.error(t.errorMsg,"",{positionClass:K}),$("#tco-payment-form").find(":submit").prop("disabled",!1))},be=function(){var t={sellerId:ce,publishableKey:ue,ccNo:$("#ccNo").val(),cvv:$("#cvv").val(),expMonth:$("#expMonth").val(),expYear:$("#expYear").val()};TCO.requestToken(ge,ve,t)};$(function(){var t=1==de?"production":"sandbox";TCO.loadPubKey(t),$("#tco-payment-form").submit(function(){return $("#tco-payment-form").find(":submit").prop("disabled",!0),be(),!1})})}}),function(t){t.fn.nameBadge=function(e){var a=t.extend({border:{color:"#ddd",width:0},colors:["#458b00","#f85931","#ce1836","#009989","#00688b","#8b1a1a"],text:"#fff",margin:2,middlename:!0,uppercase:!0,max:3},e);return this.each(function(){var e=t(this).text(),i=t(this).attr("data-image-size")?t(this).attr("data-image-size"):60;e.trim()||(e="User");var r=e.match(a.middlename?/\b(\w)/g:/^\w|\b\w(?=\S+$)/g),o=r.join("");o=o.substr(0,a.max),t(this).text(o),t(this).css({color:a.text,"background-color":a.colors[Math.floor(Math.random()*a.colors.length)],border:a.border.width+"px solid "+a.border.color,display:"inline-block","font-family":"Arial, 'Helvetica Neue', Helvetica, sans-serif","font-size":.4*i,"border-radius":i+"px",width:i+"px",height:i+"px","line-height":i+"px",margin:a.margin+"px","text-align":"center","float":"left","text-transform":a.uppercase?"uppercase":""})})}}(jQuery);




